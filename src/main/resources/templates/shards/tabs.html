<!-- Сюда решил вынести целиком всю таблицу с user и создание нового пользователя -->

<!— templates/fragments/tabs.html —>
<div th:fragment="tabs(users, allRoles, csrf)"
     class="container my-5">

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="users-tab" data-bs-toggle="tab"
                    data-bs-target="#users" type="button" role="tab">
                Users
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="new-user-tab" data-bs-toggle="tab"
                    data-bs-target="#new-user" type="button" role="tab">
                New user
            </button>
        </li>
    </ul>

    <div class="tab-content mt-3" id="myTabContent">
        <!-- Таблица пользователей -->
        <div class="tab-pane fade show active" id="users" role="tabpanel">
            <h2 class="mb-3">Users</h2>
            <table class="table table-striped table-bordered">
                <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>First name</th>
                    <th>Last name</th>
                    <th>Age</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${users}">
                    <td th:text="${user.id}"></td>
                    <td th:text="${user.name}"></td>
                    <td th:text="${user.lastName}"></td>
                    <td th:text="${user.age}"></td>
                    <td th:text="${user.email}"></td>
                    <td th:text="${user.getRoleCorrectNames()}"></td>
                    <td>
                        <button class="btn btn-sm btn-info me-2"
                                type="button"
                                th:attr="data-user-id=${user.id},
                                         data-name=${user.name},
                                         data-lastname=${user.lastName},
                                         data-email=${user.email},
                                         data-age=${user.age},
                                         data-roles=${user.getRoleIdsAsString()}"
                                onclick="openEditModal(this)">
                            Edit
                        </button>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-danger"
                                type="button"
                                th:attr="data-user-id=${user.id},
                                         data-name=${user.name},
                                         data-lastname=${user.lastName},
                                         data-email=${user.email},
                                         data-age=${user.age},
                                         data-roles=${user.getRoleIdsAsString()}"
                                onclick="openDeleteModal(this)">
                            Remove
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Создание нового пользователя -->
        <div
                class="tab-pane fade"
                id="new-user"
                role="tabpanel"
                aria-labelledby="new-user-tab">
            <h3 class="mb-3">Create new user</h3>
            <div class="container mt-5">
                <div class="row justify-content-center">
                    <div class="col-md-6 col-lg-4">

                        <form name="formAuth" action="/admin" method="post" class="needs-validation">
                            <div class="mb-3">
                                <label for="name" class="form-label fw-bold text-center w-100">First
                                    name</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                                <div class="invalid-feedback">
                                    Set user first name
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="lastName" class="form-label fw-bold text-center w-100">Last
                                    name</label>
                                <input type="text" class="form-control" id="lastName" name="lastName"
                                       required>
                                <div class="invalid-feedback">
                                    Set user lastname
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="email"
                                       class="form-label fw-bold text-center w-100">Email</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                                <div class="invalid-feedback">
                                    Set user email
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="age" class="form-label fw-bold text-center w-100">Age</label>
                                <input type="number" class="form-control" id="age" name="age" required>
                                <div class="invalid-feedback">
                                    Set user age
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="password"
                                       class="form-label fw-bold text-center w-100">Password</label>
                                <input type="text" class="form-control" id="password" name="password"
                                       required>
                                <div class="invalid-feedback">
                                    Set user password
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="roles"
                                       class="form-label fw-bold text-center w-100">Roles</label>
                                <select multiple class="form-select" id="roles" name="roleIds" size="2">
                                    <option th:each="role : ${allRoles}"
                                            th:value="${role.id}"
                                            th:text="${role.name}"></option>
                                </select>
                            </div>

                            <!-- CSRF токен -->
                            <input type="hidden" name="_csrf" th:value="${_csrf.token}">

                            <!-- Кнопка отправки -->
                            <div class="d-grid mb-3">
                                <button type="submit" class="btn btn-primary">Add new user</button>
                            </div>

                            <!-- Сообщение об ошибке -->
                            <div th:if="${param.error}" class="alert alert-danger" role="alert">
                                Invalid data, please try again
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>